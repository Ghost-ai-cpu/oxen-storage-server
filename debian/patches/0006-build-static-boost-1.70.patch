From: Jason Rhinelander <jason@imaginary.ca>
Date: Sat, 16 Jan 2021 00:40:17 -0400
Subject: build static boost

storage server needs boost 1.66+
---
 CMakeLists.txt | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index d3bb0d7..f7734d7 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -66,8 +66,6 @@ else()
   # Need this target export so that loki-mq properly picks up sodium
   export(TARGETS sodium NAMESPACE sodium:: FILE sodium-exports.cmake)
 
-  find_package(Boost REQUIRED system program_options)
-
   find_package(OpenSSL REQUIRED)
 endif()
 
@@ -79,6 +77,18 @@ include(cmake/check_for_std_filesystem.cmake)
 if(NOT BUILD_STATIC_DEPS)
 endif()
 
+add_library(boost_core INTERFACE)
+target_include_directories(boost_core SYSTEM INTERFACE "${CMAKE_SOURCE_DIR}/boost/include")
+add_library(Boost::boost ALIAS boost_core)
+add_library(Boost::program_options STATIC IMPORTED GLOBAL)
+set_target_properties(Boost::program_options PROPERTIES
+    IMPORTED_LOCATION "${CMAKE_SOURCE_DIR}/boost/lib/libboost_program_options.a"
+    INTERFACE_INCLUDE_DIRECTORIES "${CMAKE_SOURCE_DIR}/boost/include")
+add_library(Boost::system STATIC IMPORTED GLOBAL)
+set_target_properties(Boost::system PROPERTIES
+    IMPORTED_LOCATION "${CMAKE_SOURCE_DIR}/boost/lib/libboost_system.a"
+    INTERFACE_INCLUDE_DIRECTORIES "${CMAKE_SOURCE_DIR}/boost/include")
+
 pkg_check_modules(OXENMQ REQUIRED IMPORTED_TARGET liboxenmq>=1.2.3)
 add_library(oxenmq_pkgconfig INTERFACE)
 target_link_libraries(oxenmq_pkgconfig INTERFACE PkgConfig::OXENMQ)
